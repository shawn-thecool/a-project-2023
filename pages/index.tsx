import Head from 'next/head'
import { useEffect, useState } from 'react'
import SimpleLayout from '../src/gg/adaptor/web/assets/layouts/SimpleLayout'
import { SiteUseCase } from '../src/gg/application/usecases/SiteUseCase'
import { SiteEntity } from '../src/gg/domain/entities'

export default function Home() {
  const userId = 'test_user_id_100'
  const siteId = 'test_site_id_10000'

  const siteUC = new SiteUseCase()
  const [site, setSite] = useState(null)
  const [siteCreateRes, setSiteCreateRes] = useState(null)

  useEffect(() => {
    siteUC.getSite(siteId).then((res) => setSite(res))
  }, [])

  const onCreateSite = async () => {
    if (!userId) return
    const site = new SiteEntity({
      id: '',
      name: 'will create site name',
      url: 'url',
      platform: 'cafe24',
      status: '',
    })
    const res = await siteUC.createSite(userId, site)
    setSiteCreateRes(res)
  }

  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name='description' content='Generated by create next app' />
        <link rel='icon' href='/favicon.ico' />
      </Head>

      <SimpleLayout
        head={'index.page'}
        main={
          <div>
            <div>
              <h2>create site</h2>
              <button onClick={onCreateSite}>create site</button>
              <pre>{JSON.stringify(siteCreateRes, null, 2)}</pre>
            </div>
            <div>
              <h2>get site by id</h2>
              <pre>{JSON.stringify(site, null, 2)}</pre>
            </div>
          </div>
        }
      />
    </>
  )
}
